<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>libTTThwart_hooked_functions.h</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Information"></a><a name="Topic44"></a><div class="CTopic TGroup LC first">
 <div class="CTitle">Information</div>
</div>

<a name="License"></a><a name="Topic8"></a><div class="CTopic TInformation LC">
 <div class="CTitle">License</div>
 <div class="CBody"><p>Whatever</p><div class="CHeading">Authors</div><p><a href="https://twitter.com/Razvieu" target="_top">Razvan Raducu</a></p><p><a href="https://twitter.com/RicardoJRdez" target="_top">Ricardo J. Rodr√≠guez</a></p><div class="CHeading">Code</div><p>You can find the source code associated with this header <a href="https://github.com/RazviOverflow/ld.so.preload/blob/master/src/libTTThwart_hooked_functions.c" target="_top">here</a>.</p></div>
</div>

<a name="General_Information"></a><a name="Topic64"></a><div class="CTopic TInformation LC">
 <div class="CTitle">General Information</div>
 <div class="CBody"><p>You can find in this file the declaration of every single <b>pointer to</b> the original functions that are being hooked. We need pointers to original functions because after all the hooking and checkin process happens, we need to call the original function in order to make this library transparent to the user.</p><p>We devide functions in two blocks based on [1]:</p><ul><li><p>Given a &quot;vulnerable sequence&quot; &lt;checkFunction, useFunction&gt; we have:</p><ul><li><p>Functions that are <b>only on the left part of the vulnerable sequence</b> (only check).&nbsp; These functions will only upsert information into the file metadata structure.</p></li><li><p>Functions that are <b>either on the left or rgiht (both sides) of the vulnerable sequence, either check, use or both.</b>&nbsp; These functions will either upsert information into the file metadata structure or will perform all the corresponding checkings given a path and inode.</p></li></ul></li></ul><p>[1] Modeling and preventing TOCTTOU vulnerabilities in Unix-style file systems.&nbsp; J Wei, C Pu - Computers &amp; Security, 2010 - Elsevier</p><p><u>Please notice how there are no function that are only on the right part, the use side, of the vulnerable sequence.</u></p></div>
</div>

<a name="Hooked_functions"></a><a name="Topic61"></a><div class="CTopic TSection LC">
 <div class="CTitle">Hooked functions</div>
</div>

<a name="Variables"></a><a name="Topic100"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Variables</div>
</div>

<a name="Left-handed_hooked_functions"></a><a name="Topic62"></a><div class="CTopic TVariable LC">
 <div class="CTitle">Left-handed hooked functions</div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry"><a name="original_xstat"></a><a name="Topic102"></a>original_xstat</td><td class="CDLDefinition"><p>Function pointer to original stat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_xstat64"></a><a name="Topic103"></a>original_xstat64</td><td class="CDLDefinition"><p>Function pointer to original stat64() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_lxstat"></a><a name="Topic104"></a>original_lxstat</td><td class="CDLDefinition"><p>Function pointer to original lstat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_lxtat64"></a><a name="Topic105"></a>original_lxtat64</td><td class="CDLDefinition"><p>Function pointer to original lstat64() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_access"></a><a name="Topic106"></a>original_access</td><td class="CDLDefinition"><p>Function pointer to original access() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_rmdir"></a><a name="Topic107"></a>original_rmdir</td><td class="CDLDefinition"><p>Function pointer to original rmdir() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_unlink"></a><a name="Topic108"></a>original_unlink</td><td class="CDLDefinition"><p>Function pointer to original unlink() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_unlinkat"></a><a name="Topic109"></a>original_unlinkat</td><td class="CDLDefinition"><p>Function pointer to original unlinkat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_remove"></a><a name="Topic110"></a>original_remove</td><td class="CDLDefinition"><p>Function pointer to original remove() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_readlink"></a><a name="Topic111"></a>original_readlink</td><td class="CDLDefinition"><p>Function pointer to original readlink() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_readlinkat"></a><a name="Topic112"></a>original_readlinkat</td><td class="CDLDefinition"><p>Function pointer to original readlinkat() function.</p></td></tr></table></div>
</div>

<a name="Both-handed_hooked_functions"></a><a name="Topic77"></a><div class="CTopic TVariable LC">
 <div class="CTitle">Both-handed hooked functions</div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry"><a name="original_symlink"></a><a name="Topic113"></a>original_symlink</td><td class="CDLDefinition"><p>Function pointer to original symlink() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_symlinkat"></a><a name="Topic114"></a>original_symlinkat</td><td class="CDLDefinition"><p>Function pointer to original symlinkat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_link"></a><a name="Topic115"></a>original_link</td><td class="CDLDefinition"><p>Function pointer to original link() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_linkat"></a><a name="Topic116"></a>original_linkat</td><td class="CDLDefinition"><p>Function pointer to original linkat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_rename"></a><a name="Topic117"></a>original_rename</td><td class="CDLDefinition"><p>Function pointer to original rename() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_renameat"></a><a name="Topic118"></a>original_renameat</td><td class="CDLDefinition"><p>Function pointer to original renameat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_creat64"></a><a name="Topic119"></a>original_creat64</td><td class="CDLDefinition"><p>Function pointer to original creat64() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_creat"></a><a name="Topic120"></a>original_creat</td><td class="CDLDefinition"><p>Function pointer to original creat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_open"></a><a name="Topic121"></a>original_open</td><td class="CDLDefinition"><p>Function pointer to original open() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_open64"></a><a name="Topic122"></a>original_open64</td><td class="CDLDefinition"><p>Function pointer to original open64() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_openat"></a><a name="Topic123"></a>original_openat</td><td class="CDLDefinition"><p>Function pointer to original openat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_fopen"></a><a name="Topic124"></a>original_fopen</td><td class="CDLDefinition"><p>Function pointer to original fopen() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_fopen64"></a><a name="Topic125"></a>original_fopen64</td><td class="CDLDefinition"><p>Function pointer to original fopen64() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_freopen"></a><a name="Topic126"></a>original_freopen</td><td class="CDLDefinition"><p>Function pointer to original freopen() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_xmknod"></a><a name="Topic127"></a>original_xmknod</td><td class="CDLDefinition"><p>Function pointer to original xmknode() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_xmknodat"></a><a name="Topic128"></a>original_xmknodat</td><td class="CDLDefinition"><p>Function pointer to original xmknodat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_mkfifo"></a><a name="Topic129"></a>original_mkfifo</td><td class="CDLDefinition"><p>Function pointer to original mkfifo() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_mkfifoat"></a><a name="Topic130"></a>original_mkfifoat</td><td class="CDLDefinition"><p>Function pointer to original mkfifoat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_chmod"></a><a name="Topic131"></a>original_chmod</td><td class="CDLDefinition"><p>Function pointer to original chmod() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_chown"></a><a name="Topic132"></a>original_chown</td><td class="CDLDefinition"><p>Function pointer to original chown() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_truncate"></a><a name="Topic133"></a>original_truncate</td><td class="CDLDefinition"><p>Function pointer to original truncate() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_truncate64"></a><a name="Topic134"></a>original_truncate64</td><td class="CDLDefinition"><p>Function pointer to original truncate64() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_utime"></a><a name="Topic135"></a>original_utime</td><td class="CDLDefinition"><p>Function pointer to original utime() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_utimes"></a><a name="Topic136"></a>original_utimes</td><td class="CDLDefinition"><p>Function pointer to original utimes() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_pathconf"></a><a name="Topic137"></a>original_pathconf</td><td class="CDLDefinition"><p>Function pointer to original pathconf() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_mkdir"></a><a name="Topic138"></a>original_mkdir</td><td class="CDLDefinition"><p>Function pointer to original mdkir() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_mkdirat"></a><a name="Topic139"></a>original_mkdirat</td><td class="CDLDefinition"><p>Function pointer to original mkdirat() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_chdir"></a><a name="Topic140"></a>original_chdir</td><td class="CDLDefinition"><p>Function pointer to original chdir() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_chroot"></a><a name="Topic141"></a>original_chroot</td><td class="CDLDefinition"><p>Function pointer to original chroot() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_execve"></a><a name="Topic142"></a>original_execve</td><td class="CDLDefinition"><p>Function pointer to original execve() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_execvpe"></a><a name="Topic143"></a>original_execvpe</td><td class="CDLDefinition"><p>Function pointer to original execvpe() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_popen"></a><a name="Topic144"></a>original_popen</td><td class="CDLDefinition"><p>Function pointer to original popen() function.</p></td></tr><tr><td class="CDLEntry"><a name="original_mount"></a><a name="Topic145"></a>original_mount</td><td class="CDLDefinition"><p>Function pointer to original mount() function.</p></td></tr></table></div>
</div>

<a name="execl*family"></a><a name="Topic63"></a><div class="CTopic TVariable LC last">
 <div class="CTitle">execl* family</div>
 <div class="CBody"><p>execl* family is being hooked but there is no need for particular function pointers since they internally call execv, execvp and execve respectively</p></div>
</div>

</body></html>